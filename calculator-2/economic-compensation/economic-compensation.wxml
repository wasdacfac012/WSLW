<view class="container">
  <view class="title">经济补偿金计算器
    <view class="title-annotation">用人单位协商一致解除劳动合同，无过失性辞退，经济性裁员情况下用人单位需要发放经济补偿金</view>
  </view>
  
  <!-- 浮窗提示1：无过失性辞退相关法律法规 -->
  <view class="floating-tip">
    <view class="tip-header" bindtap="toggleTip1">
      <text class="tip-title">无过失性辞退相关法律法规</text>
      <text class="tip-arrow">{{showTip1 ? '▲' : '▼'}}</text>
    </view>
    <view class="tip-content {{collapsing1 ? 'collapsing' : ''}}" wx:if="{{showTip1}}">
      <view class="tip-section">
        <text class="tip-section-title">《劳动合同法》第四十条</text>
        <text class="tip-section-desc">有下列情形之一的，用人单位提前三十日以书面形式通知劳动者本人或者额外支付劳动者一个月工资后，可以解除劳动合同：</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（一）</text>
        <text class="tip-item-content">劳动者患病或者非因工负伤，在规定的医疗期满后不能从事原工作，也不能从事由用人单位另行安排的工作的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（二）</text>
        <text class="tip-item-content">劳动者不能胜任工作，经过培训或者调整工作岗位，仍不能胜任工作的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（三）</text>
        <text class="tip-item-content">劳动合同订立时所依据的客观情况发生重大变化，致使劳动合同无法履行，经用人单位与劳动者协商，未能就变更劳动合同内容达成协议的。</text>
      </view>
      <view class="tip-section">
        <text class="tip-section-title">《劳动合同法》第四十六条</text>
        <text class="tip-section-desc">有下列情形之一的，用人单位应当向劳动者支付经济补偿：</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（一）</text>
        <text class="tip-item-content">劳动者依照本法第三十八条规定解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（二）</text>
        <text class="tip-item-content">用人单位依照本法第三十六条规定向劳动者提出解除劳动合同并与劳动者协商一致解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（三）</text>
        <text class="tip-item-content">用人单位依照本法第四十条规定解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（四）</text>
        <text class="tip-item-content">用人单位依照本法第四十一条第一款规定解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（五）</text>
        <text class="tip-item-content">除用人单位维持或者提高劳动合同约定条件续订劳动合同，劳动者不同意续订的情形外，依照本法第四十四条第一项规定终止固定期限劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（六）</text>
        <text class="tip-item-content">依照本法第四十四条第四项、第五项规定终止劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（七）</text>
        <text class="tip-item-content">法律、行政法规规定的其他情形。</text>
      </view>
      <view class="tip-section">
        <text class="tip-section-title">《劳动合同法》第四十七条</text>
        <text class="tip-section-desc">经济补偿按劳动者在本单位工作的年限，每满一年支付一个月工资的标准向劳动者支付。六个月以上不满一年的，按一年计算；不满六个月的，向劳动者支付半个月工资的经济补偿。</text>
      </view>
    </view>
  </view>
  
  <!-- 浮窗提示2：什么是法律规定的经济性裁员 -->
  <view class="floating-tip">
    <view class="tip-header" bindtap="toggleTip2">
      <text class="tip-title">什么是法律规定的经济性裁员</text>
      <text class="tip-arrow">{{showTip2 ? '▲' : '▼'}}</text>
    </view>
    <view class="tip-content {{collapsing2 ? 'collapsing' : ''}}" wx:if="{{showTip2}}">
      <!-- 第四十一条 -->
      <view class="tip-section">
        <text class="tip-section-title">《劳动合同法》第四十一条</text>
        <text class="tip-section-desc">有下列情形之一，需要裁减人员二十人以上或者裁减不足二十人但占企业职工总数百分之十以上的，用人单位提前三十日向工会或者全体职工说明情况，听取工会或者职工的意见后，裁减人员方案经向劳动行政部门报告，可以裁减人员：</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（一）</text>
        <text class="tip-item-content">依照企业破产法规定进行重整的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（二）</text>
        <text class="tip-item-content">生产经营发生严重困难的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（三）</text>
        <text class="tip-item-content">企业转产、重大技术革新或者经营方式调整，经变更劳动合同后，仍需裁减人员的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（四）</text>
        <text class="tip-item-content">其他因劳动合同订立时所依据的客观经济情况发生重大变化，致使劳动合同无法履行的。</text>
      </view>
      
      <view class="tip-section">
        <text class="tip-section-desc">裁减人员时，应当优先留用下列人员：</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（一）</text>
        <text class="tip-item-content">与本单位订立较长期限的固定期限劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（二）</text>
        <text class="tip-item-content">与本单位订立无固定期限劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（三）</text>
        <text class="tip-item-content">家庭无其他就业人员，有需要扶养的老人或者未成年人的。</text>
      </view>
      
      <view class="tip-section">
        <text class="tip-section-desc">用人单位依照本条第一款规定裁减人员，在六个月内重新招用人员的，应当通知被裁减的人员，并在同等条件下优先招用被裁减的人员。</text>
      </view>
      
      <!-- 第四十六条 -->
      <view class="tip-section">
        <text class="tip-section-title">《劳动合同法》第四十六条</text>
        <text class="tip-section-desc">有下列情形之一的，用人单位应当向劳动者支付经济补偿：</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（一）</text>
        <text class="tip-item-content">劳动者依照本法第三十八条规定解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（二）</text>
        <text class="tip-item-content">用人单位依照本法第三十六条规定向劳动者提出解除劳动合同并与劳动者协商一致解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（三）</text>
        <text class="tip-item-content">用人单位依照本法第四十条规定解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（四）</text>
        <text class="tip-item-content">用人单位依照本法第四十一条第一款规定解除劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（五）</text>
        <text class="tip-item-content">除用人单位维持或者提高劳动合同约定条件续订劳动合同，劳动者不同意续订的情形外，依照本法第四十四条第一项规定终止固定期限劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（六）</text>
        <text class="tip-item-content">依照本法第四十四条第四项、第五项规定终止劳动合同的；</text>
      </view>
      <view class="tip-item">
        <text class="tip-item-title">（七）</text>
        <text class="tip-item-content">法律、行政法规规定的其他情形。</text>
      </view>
      
      <!-- 第四十七条 -->
      <view class="tip-section">
        <text class="tip-section-title">《劳动合同法》第四十七条</text>
        <text class="tip-section-desc">经济补偿按劳动者在本单位工作的年限，每满一年支付一个月工资的标准向劳动者支付。六个月以上不满一年的，按一年计算；不满六个月的，向劳动者支付半个月工资的经济补偿。</text>
      </view>
    </view>
  </view>
  
  <view class="input-group">
    <text class="label">用工月数 (N):</text>
    <input type="digit" class="input" placeholder="个月" bindinput="bindKeyInput" data-field="n" />
  </view>

  <view class="input-group">
    <text class="label">前十二个月的平均工资 (P):</text>
    <input type="digit" class="input" placeholder="元" bindinput="bindKeyInput" data-field="p" />
  </view>

  <view class="input-group">
    <text class="label">最低工资基数:</text>
    <input type="digit" class="input" placeholder="元" bindinput="bindKeyInput" data-field="minWage" />
  </view>

  <view class="input-group">
    <text class="label">当地社平工资:</text>
    <input type="digit" class="input" placeholder="元" bindinput="bindKeyInput" data-field="avgWage" />
  </view>

  <button class="btn-calculate" bindtap="calculate">计算</button>

  <view class="result-area" wx:if="{{result !== null}}">
    <view class="result-item">
      <text class="result-title">经济补偿金:</text>
      <text class="result-value">{{result.compensation}} 元</text>
    </view>
    
    <view class="result-item">
      <text class="result-title">经济赔偿金:</text>
      <text class="result-value">{{result.compensationDouble}} 元</text>
    </view>
    
    <view class="result-item">
      <text class="result-title">代通知金:</text>
      <text class="result-value">{{result.noticePay}} 元</text>
    </view>
    
    <button class="btn-copy" bindtap="copyResult">复制结果</button>
    
    <view class="detail-toggle" bindtap="toggleDetail">
      <text class="detail-toggle-text">{{showDetail ? '收起' : '展开'}}详细计算过程</text>
      <text class="detail-toggle-icon">{{showDetail ? '▲' : '▼'}}</text>
    </view>
    
    <view class="detail-process" wx:if="{{showDetail}}">
      <text class="detail-content">{{detailProcess}}</text>
    </view>
  </view>
</view>
